<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>SVFOpportunityButton20161214104634423bjW</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>受注検討票_出力</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>/**
 * SVF Button for Detail Page onClick JavaScript
 *
 * Generated by SVF Cloud. Do not edit.
 *
 * @version 1.1.3
 */
(function menuBtn(){
  {!REQUIRESCRIPT(&apos;//repo.svfcloud.com/service/sfdc/release-rg/lib/js/jquery-1.8.3.min.js&apos;)};
  {!REQUIRESCRIPT(&apos;/soap/ajax/41.0/connection.js&apos;)};
  {!REQUIRESCRIPT(&apos;/soap/ajax/41.0/apex.js&apos;)};

  var print_button = document.getElementsByName(&quot;svfopportunitybutton20161214104634423bjw&quot;)[0];
  var buttonsJson = &apos;{&quot;fullName&quot;:&quot;SVFOpportunityButton20161214104634423bjW&quot;,&quot;label&quot;:&quot;受注検討票_出力&quot;}&apos;;
  var button = JSON.parse(buttonsJson);
  var printedFlg = (button.forbiddenField != null)
    ? button.forbiddenField
    : &quot;&quot;;

  var printed_cnt=0;
  if(printedFlg.length &gt; 0 &amp;&amp; printedFlg!=&quot;&quot;){
    try{
      var sobjects = sforce.connection.retrieve(&quot;Id,&quot;+printedFlg, &quot;Opportunity&quot;, [&quot;{!Opportunity.Id}&quot;]);
      if(printedFlg!=&quot;&quot;){
        for (var i=0; i &lt; sobjects.length; i++) {
          if(sobjects[i].get(printedFlg) == &quot;true&quot;) printed_cnt++;
        }
      }
    } catch (e){
      if(e.toString().includes(&quot;sf:INVALID_FIELD&quot;)){
        var indexColumn = e.toString().indexOf(&quot;No such column &quot;,0);
        var endOfColumn = e.toString().indexOf(&quot; on entity &quot;,indexColumn+15);
        var invalid_field = e.toString().substring(indexColumn+15,endOfColumn);
        alert(&quot;\u5FC5\u8981\u306A\u9805\u76EE\u306B\u30A2\u30AF\u30BB\u30B9\u51FA\u6765\u307E\u305B\u3093\u3002\u7BA1\u7406\u8005\u306B\u304A\u554F\u5408\u305B\u4E0B\u3055\u3044\u3002 You can not access the required fields.Please contact your administrator.Field=[&quot;+invalid_field+&quot;]&quot;);
        return false;
      }
    }
  }
  var executable = true;
  if( 1==printed_cnt ){ alert(&quot;\u51fa\u529b\u3092\u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044\u30ec\u30b3\u30fc\u30c9\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002 Outputting is not allowed for some records.&quot;); executable = false;}
  else if( printed_cnt &gt; 0){ alert(&quot;\u51fa\u529b\u3092\u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044\u30ec\u30b3\u30fc\u30c9\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002 Outputting is not allowed for some records.&quot;); executable = false;}

  if(executable){
    var target = &quot;svfpreview_&quot; + new Date().getTime();
    var screenLeft = window.screenX;
    var screenTop = window.screenY;

    var popup = window.open(&quot;about:blank&quot;, target, &quot;menubar=no, toolbar=no, scrollbars=yes, resizable=yes, width=600, height=300, top=&quot; + screenTop + &quot;, left=&quot; + screenLeft);
    if ( popup ) {
      popup.focus();
    }

    var form = document.createElement(&apos;form&apos;);
    form.method = &apos;POST&apos;;
    form.action = (button.forbiddenField != null)
      ?&apos;{!LEFT($Api.Partner_Server_URL_410,FIND(&quot;/services/Soap/&quot;, $Api.Partner_Server_URL_410))}/apex/svfcloud__PreviewPage?appId=Opportunity&amp;id={!Opportunity.Id}&amp;buttonFullName=&apos;+button.fullName+&apos;&amp;printedFlg=&apos;+button.forbiddenField
      :&apos;{!LEFT($Api.Partner_Server_URL_410,FIND(&quot;/services/Soap/&quot;, $Api.Partner_Server_URL_410))}/apex/svfcloud__PreviewPage?appId=Opportunity&amp;id={!Opportunity.Id}&amp;buttonFullName=&apos;+button.fullName;
    form.target = target;
    var body = document.getElementsByTagName(&apos;body&apos;)[0];
    body.appendChild(form);
    form.submit();
    body.removeChild(form);
  }

}())</url>
</WebLink>
